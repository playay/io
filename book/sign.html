<script src="//cdn.feling.io/js/jquery-3.3.1.min.js"></script>
<script>

function getQueryParamAndClearAll(key) {
    var reg = new RegExp("(^|&)" + key + "=([^&]*)(&|$)");
    var r = window.top.location.search.substr(1).match(reg);
    if (r != null) {
        return decodeURIComponent(r[2])
    }
    return null;
}


if (localStorage.book_sgin && localStorage.book_user_name) {
    window.location.replace("https://feling.io/book/")
} else {
    sign = getQueryParamAndClearAll('sign')
    user_name = getQueryParamAndClearAll('user_name')
    if (sign) {
        localStorage.book_sgin = sign
        localStorage.book_user_name = user_name
        window.location.replace("https://feling.io/book/")
    } else {
        var url = "https://open.weixin.qq.com/connect/oauth2/authorize?"
                + "appid=ww6f88babe6ddb78da&"
                + "redirect_uri=https%3A%2F%2Ffeling.io%2Fapi%2Funclassified%2Fbook%2Fsign"
                + "&response_type=code&scope=snsapi_base&state=STATE#wechat_redirect"
        window.location.replace(url)
    }
}
</script>


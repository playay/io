<nav class="uk-navbar">
    <a class="uk-navbar-brand uk-hidden-large" href="/">/</a>

    <ul id="navbar-nav" class="uk-navbar-nav uk-visible-large">
        <li v-if="'{{ page.title }}' != 'feling.io'" v-bind:class="{ 'uk-active': '{{ page.title }}' == 'Json 格式化' }">
            <a href="/json/">Json</a></li>

        <li v-if="'{{ page.title }}' != 'feling.io'" v-bind:class="{ 'uk-active': '{{ page.title }}' == 'Base64 编解码' }">
            <a href="/base64/">Base64</a></li>

        <li v-if="'{{ page.title }}' != 'feling.io'" v-bind:class="{ 'uk-active': '{{ page.title }}' == 'fredis' }">
                <a href="/redis/">Redis</a></li>
        <li v-if="'{{ page.title }}' != 'feling.io'" class="uk-parent" data-uk-dropdown="{mode:'click'}">
            <a class="uk-navbar-content">more <i class="uk-icon-caret-down"></i></a>
            <div class="uk-dropdown uk-dropdown-small uk-dropdown-navbar">
                <ul class="uk-nav uk-nav-navbar">
                    <li><a href="/timestamp/">timestamp</a></li>
                </ul>
            </div>
        </li>
    </ul>

    <div class="uk-navbar-flip">
        <a id="signInButton" class="uk-navbar-brand" onselectstart="return false;" onClick="signIn()"
            style="display:none;font-weight:bold;font-size:16px;">
            <i id="signInSpinner" class="uk-icon-spinner uk-icon-spin" style="display:none"></i>
            Sign In With Google
        </a>
        <ul id="userAvatarAndName" class="uk-navbar-nav" style="display:none;">
            <li class="uk-parent" data-uk-dropdown="{mode:'click'}">
                <div class="uk-navbar-content">
                    <img id="userAvatar" style="width:30px;height:30px;border-radius:50%;">
                    <span id="userName"></span>
                </div>
                <div class="uk-dropdown uk-dropdown-small uk-dropdown-navbar">
                    <ul class="uk-nav uk-nav-navbar">
                        <li><a href="mailto:chenyan@feling.net?subject=对“{{ page.title }}”的意见与建议">Feedback</a></li>
                        <li><a onClick="signOut()">Sign Out <i id="signOutSpinner" class="uk-icon-spinner uk-icon-spin" style="display:none"></i></a></li>
                    </ul>
                </div>
            </li>
        </ul>
        <script>
            function signIn() {
                if (typeof googleyolo == "undefined") {
                    UIkit.modal.alert('谷歌一键登录操作失败, 请确认网络环境')
                    return
                }
                signInWithGoogle(true)
            }
            function signOut() {
                $("#signOutSpinner").show()
                WithFParams.postForm('/login/signOut', {}, () => { })
                    .always(() => {
                        localStorage.removeItem('accessToken')
                        localStorage.removeItem('userAvatar')
                        localStorage.removeItem('userName')
                        $("#signInButton").show()
                        $("#userAvatarAndName").hide()
                        $("#signOutSpinner").hide()
                    })
                if (typeof googleyolo != "undefined") {
                    googleyolo.disableAutoSignIn().then(() => { })
                }
            }
            function loadUserAvatarAndNameFormLocalStorage2ShowInNavBar () {
                if (localStorage.accessToken) {
                    $("#userAvatar").attr("src", localStorage.userAvatar)
                    $("#userName").html(localStorage.userName)
                    $("#userAvatarAndName").show()
                    $("#signInButton").hide()
                } else {
                    $("#userAvatarAndName").hide()
                }
            }
            if (localStorage.accessToken) {
                WithFParams.postForm('/login/getLoginInfo',
                    {
                        accessToken: localStorage.accessToken
                    },
                    (result) => {
                        if (result.success && result.data) {
                            localStorage.userAvatar = result.data.userAvatar
                            localStorage.userName = result.data.userName
                        } else {
                            localStorage.removeItem('accessToken')
                            localStorage.removeItem('userAvatar')
                            localStorage.removeItem('userName')
                            $("#signInButton").show()
                            $("#userAvatarAndName").hide()
                        }
                    }
                ).always(() => {
                    loadUserAvatarAndNameFormLocalStorage2ShowInNavBar()
                })
            } else {
                loadUserAvatarAndNameFormLocalStorage2ShowInNavBar()
            }
        </script>
    </div>

    <div id="navbar-ad" style="display:none;float:right;" 
            class="uk-navbar-content uk-visible-large">
        {% raw %}
        <a v-if="ad.href" style="color:#444444;font-size:10px;" target="_blank" :href="ad.href">{{ ad.title }}</a>
        <span v-else style="color:#444444;font-size:10px;">{{ ad.title }}</span>
        {% endraw %}
    </div>

    <ul id="navbar-donate" class="uk-navbar-nav uk-navbar-content uk-navbar-center uk-visible-large">
        <li class="uk-parent" data-uk-dropdown="{mode:'click'}">
            <a class="uk-navbar-content">donate</a>
            <div class="uk-grid uk-grid-divider uk-dropdown uk-dropdown-navbar" style="width:648px;">
                <div class="uk-width-1-3">
                    <p><i class="uk-icon-wechat"></i> WeChat</p>
                    <img src="//cdn.feling.io/images/donate-wechat.png" style="width:128px;height:128px;"/>
                </div>
                <div class="uk-width-1-3" style="height:159px;">
                    <p><i class="uk-icon-paypal"></i> PayPal</p>
                    <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank">
                        <input type="hidden" name="cmd" value="_s-xclick">
                        <input type="hidden" name="hosted_button_id" value="DSPBFQCFXUZZW">
                        <table>
                        <tr><td><input type="hidden" name="on0" value="donate for feling.io"></td></tr><tr><td><select name="os0">
                            <option value="1)">$ 3.00 USD</option>
                            <option value="2)">$ 5.00 USD</option>
                            <option value="3)">$ 10.00 USD</option>
                            <option value="4)">$ 15.00 USD</option>
                            <option value="5)">$ 20.00 USD</option>
                        </select> </td></tr>
                        </table>
                        <input type="hidden" name="currency_code" value="USD">
                        <input type="image" src="https://www.paypalobjects.com/en_GB/i/btn/btn_paynow_SM.gif" border="0" name="submit" alt="PayPal – The safer, easier way to pay online!">
                        <img alt="" border="0" src="https://www.paypalobjects.com/zh_XC/i/scr/pixel.gif" width="1" height="1">
                    </form>
                </div>
                <div class="uk-width-1-3">
                    <p><img src="//cdn.feling.io/images/icon-alipay.svg" style="width:18px;height:16px;"/> Alipay</p>
                    <img src="//cdn.feling.io/images/donate-alipay.png" style="width:128px;height:128px;"/>
                </div>
            </div>
        </li>
    </ul>

</nav>
<script>
    var vm_navbar_nav = new Vue({
        el: '#navbar-nav'
    })
</script>
<div id="googleThings"></div>
<script src="//cdn.feling.io/js/googleThings.js" async></script>
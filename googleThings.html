

<div>
    <!-- 谷歌分析 -->
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-62897210-2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'UA-62897210-2');
    </script>

    <!-- 谷歌一键登录 -->
    <script src="https://smartlock.google.com/client"></script>
    <script>
        function signOut () {
            googleyolo.disableAutoSignIn().then(() => {})
            WithFParams.postForm('/login/signOut', {},
                function loginResultHandler(result) {
                    localStorage.removeItem('accessToken')
                    localStorage.removeItem('userAvatar')
                    localStorage.removeItem('userName')
                    loadUserAvatarAndNameFormLocalStorage2ShowInNavBar()
                }
            )
        }
        function signIn () {
            const hintPromise = googleyolo.hint({
                supportedAuthMethods: [
                    "https://accounts.google.com"
                ],
                supportedIdTokenProviders: [
                    {
                        uri: "https://accounts.google.com",
                        clientId: "1093205252929-cm3ev302entgv6kutudb7i077je31g3r.apps.googleusercontent.com"
                    }
                ]
            });

            hintPromise.then((credential) => {
                if (credential.idToken) {
                    useGoogleIdTokenForAuth(credential.idToken);
                }
            }, (error) => {
                console.log('hint error: ', error)
            });
        }

        function useGoogleIdTokenForAuth (idToken) {
            WithFParams.postForm('/login/withGoogle',
                {
                    "idToken": idToken
                },
                function loginResultHandler(result) {
                    if (result.success) {
                        localStorage.accessToken = result.data.accessToken
                        localStorage.userAvatar = result.data.userAvatar
                        localStorage.userName = result.data.userName
                        loadUserAvatarAndNameFormLocalStorage2ShowInNavBar()
                    } else {
                        localStorage.removeItem('accessToken')
                        console.log(result.message)
                    }
                }
            )
        }
        window.onGoogleYoloLoad = (googleyolo) => {
            googleyolo = googleyolo
            if (localStorage.accessToken) {
                return
            }
            const retrievePromise = googleyolo.retrieve({
                supportedAuthMethods: [
                    "https://accounts.google.com"
                ],
                supportedIdTokenProviders: [
                    {
                        uri: "https://accounts.google.com",
                        clientId: "1093205252929-cm3ev302entgv6kutudb7i077je31g3r.apps.googleusercontent.com"
                    }
                ]
            });
            retrievePromise.then((credential) => {
                if (credential.idToken) {
                    useGoogleIdTokenForAuth(credential.idToken)
                }
            }, (error) => {});
        }
    </script>
</div>